SELECT 0;
SELECT 0;
With totalECTS(studentid,degreeid,totalECTS) AS( SELECT studentregistrationstodegrees.studentid,studentregistrationstodegrees.degreeid,SUM(courses.ects) AS totalECTS FROM studentregistrationstodegrees, courseregistrations,courses,courseoffers WHERE studentregistrationstodegrees.studentregistrationid=courseregistrations.studentregistrationid AND courses.courseid=courseoffers.courseid AND courseoffers.courseofferid=courseregistrations.courseofferid AND courseregistrations.grade>=5 GROUP BY studentregistrationstodegrees.studentid,studentregistrationstodegrees.degreeid),noneCourseTaken(studentid,degreeid,counts) AS(SELECT  studentregistrationstodegrees.studentid, studentregistrationstodegrees.degreeid,count(*) FROM studentregistrationstodegrees, courseregistrations WHERE studentregistrationstodegrees.studentregistrationid=courseregistrations.studentregistrationid AND courseregistrations.grade is NULL GROUP BY studentregistrationstodegrees.studentid,studentregistrationstodegrees.degreeid), courseTakenSelect(studentid,degreeid,counts) As ( SELECT studentregistrationstodegrees.studentid, studentregistrationstodegrees.degreeid,count(*) AS Counts FROM studentregistrationstodegrees, courseregistrations WHERE studentregistrationstodegrees.studentregistrationid=courseregistrations.studentregistrationid GROUP BY studentregistrationstodegrees.studentregistrationid),noneCourseTakenStudents(studentid,degreeid) AS( SELECT courseTakenSelect.studentid,courseTakenSelect.degreeid FROM courseTakenSelect,noneCourseTaken WHERE noneCourseTaken.studentid=courseTakenSelect.studentid AND noneCourseTaken.degreeid=courseTakenSelect.degreeid AND noneCourseTaken.counts=courseTakenSelect.counts), activeStudents(studentid,degreeid) AS (SELECT noneCourseTakenStudents.studentid,noneCourseTakenStudents.degreeid FROM noneCourseTakenStudents UNION ALL SELECT totalECTS.studentid,totalECTS.degreeid FROM totalECTS, degrees WHERE totalECTS.degreeid=degrees.degreeid AND totalECTS.totalECTS < degrees.totalects),totalStudents(degreeid,total) AS (SELECT activeStudents.degreeid, COUNT(*) FROM activeStudents GROUP BY degreeid), totalFemaleStudents(degreeid,totalFemale) AS(SELECT activeStudents.degreeid,COUNT(*) FROM students,activeStudents WHERE students.studentid=activeStudents.studentid AND students.gender='F' GROUP BY degreeid) SELECT totalStudents.degreeiD,CAST(totalFemaleStudents.totalFemale AS FLOAT)/CAST(totalStudents.total AS FLOAT) * 1.0 AS percentage FROM totalStudents,totalFemaleStudents WHERE totalStudents.degreeid=totalFemaleStudents.degreeid ORDER BY totalStudents.degreeId;
SELECT 0;
SELECT 0;
SELECT 0;
SELECT 0;
SELECT 0;